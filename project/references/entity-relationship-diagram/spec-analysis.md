# 既存テストケースと公式仕様の照合・不足分析

## 1. 既存テストケースでカバーされている仕様

### 1.1 リレーション記法
- ✅ `||--o{`：正確に1対0以上（テストケース1, 2, 5）
- ✅ `||--|{`：正確に1対1以上（テストケース2）
- ✅ `}|..|{`：1以上対1以上（テストケース1）
- ✅ `}o..o{`：0以上対0以上（テストケース3）
- ✅ 自然言語記法：`1 to zero or more`、`many(0) optionally to 0+`（テストケース4）

### 1.2 エンティティ定義
- ✅ 基本的なエンティティ定義（全テストケース）
- ✅ ハイフン付きエンティティ名：`LINE-ITEM`、`DELIVERY-ADDRESS`（テストケース1）
- ✅ 属性ブロック付きエンティティ（テストケース2, 5）

### 1.3 属性定義
- ✅ 基本データ型：`string`、`int`、`float`（テストケース2, 5）
- ✅ 配列型：`string[]`（テストケース5）
- ✅ 長さ制約付き型：`string(99)`（テストケース5）

### 1.4 キー定義
- ✅ `PK`：プライマリキー（テストケース5）
- ✅ `FK`：外部キー（テストケース5）
- ✅ `UK`：ユニークキー（テストケース5）
- ✅ 複数キー：`PK, FK`（テストケース5）

### 1.5 その他
- ✅ タイトル定義：`---title: Order example---`（テストケース1）
- ✅ コメント付き属性：`"The license #"`（テストケース5）
- ✅ 関連エンティティ：`NAMED-DRIVER`（テストケース3, 4, 5）

## 2. 既存テストケースで不足している仕様

### 2.1 リレーション記法の不足
- ❌ `|o--||`：0または1対正確に1
- ❌ `|o..|o`：0または1対0または1（非識別関係）
- ❌ `||..||`：正確に1対正確に1（非識別関係）
- ❌ `}o--|{`：0以上対1以上（識別関係）
- ❌ エイリアス記法：`only one to one or more`、`0+ optionally to 1+`など

### 2.2 エンティティ定義の不足
- ❌ 二重引用符で囲まれたエンティティ名（空白を含む）
- ❌ Unicode文字を含むエンティティ名
- ❌ Markdownフォーマット付きエンティティ名
- ❌ エンティティエイリアス：`p[Person]`

### 2.3 属性定義の不足
- ❌ その他のデータ型：`boolean`、`date`、`timestamp`など
- ❌ カスタム型：`timestamp with time zone`、`public.year`
- ❌ 精度指定：`numeric(4,2)`、`varchar(5)`、`character(20)`
- ❌ ジェネリック型：`type~T~`
- ❌ アスタリスク付きPK定義：`*id`

### 2.4 特殊機能の不足
- ❌ ダイアグラム方向指定：`direction TB/BT/LR/RL`
- ❌ 複数ブロックでの同一エンティティ定義

### 2.5 エラーケース・境界値の不足
- ❌ 不完全なリレーション定義（ラベルなし等）
- ❌ 無効なカーディナリティ記号
- ❌ 二重引用符を含むコメント
- ❌ 空のエンティティブロック
- ❌ 重複キー定義
- ❌ 循環参照リレーション

## 3. 推奨される追加テストケース

### 3.1 高優先度（基本機能）
1. 全カーディナリティ組み合わせのテスト
2. エンティティエイリアスのテスト
3. ダイアグラム方向指定のテスト
4. より多様なデータ型のテスト

### 3.2 中優先度（高度な機能）
1. Unicode・Markdown対応のテスト
2. 複数ブロックエンティティ定義のテスト
3. 自然言語記法の網羅的テスト

### 3.3 低優先度（エラーハンドリング）
1. 各種エラーケースのテスト
2. 境界値テスト
3. パフォーマンステスト（大規模ダイアグラム）

## 4. 要件定義への反映事項

### 4.1 必須要件
- 全カーディナリティ記号のサポート
- 識別/非識別関係の区別
- 基本的なデータ型と配列型のサポート
- PK/FK/UKキー定義のサポート
- コメント機能のサポート

### 4.2 推奨要件
- エンティティエイリアスのサポート
- ダイアグラム方向指定のサポート
- 自然言語記法のサポート
- より多様なデータ型のサポート

### 4.3 オプション要件
- Unicode・Markdownサポート
- カスタムデータ型のサポート
- 複数ブロックエンティティ定義のサポート